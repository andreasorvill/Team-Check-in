<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SANA Check-In</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f4f4f4;
    }

    .page {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }

    /* LOGIN PAGE --------------------------------------------------- */

    #loginPage {
      padding-top: 50px;
    }

    #bigLogo {
      width: 260px;
      max-width: 90%;
      margin-bottom: 30px;
    }

    input[type="password"],
    input[type="text"] {
      width: 90%;
      padding: 12px;
      margin-top: 10px;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #aaa;
    }

    #loginBtn {
      margin-top: 20px;
      width: 90%;
      padding: 12px;
      background: #005691; /* Epiroc deep blue */
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      border-radius: 8px;
    }

    /* MAIN PAGE --------------------------------------------------- */

    #mainPage {
      display: none;
    }

    #topIcon {
      width: 60px;
      margin: 20px auto;
      display: block;
    }

    h1 {
      color: #005691;
      margin-bottom: 10px;
    }

    .word-list {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 20px;
    }

    .word-item {
      background: white;
      padding: 12px;
      border: 1px solid #bbb;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }

    .word-item.selected {
      background: #ffc400;   /* Epiroc yellow highlight */
      border-color: #ffc400;
    }

    textarea {
      width: 100%;
      height: 120px;
      padding: 10px;
      margin-top: 15px;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #bbb;
      resize: vertical;
    }

    button.main-btn {
      margin-top: 20px;
      width: 100%;
      padding: 14px;
      background: #005691;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      border-radius: 8px;
    }

    button.main-btn:disabled {
      background: #999;
      cursor: not-allowed;
    }

    #adminBtn {
      margin-top: 15px;
      background: #333;
    }
  </style>
</head>

<body>

  <!-- ---------------- LOGIN PAGE ---------------- -->
  <div id="loginPage" class="page">
    <img id="bigLogo" src="images/SANA_Yellow_bkg.png" alt="SANA Logo">

    <h2>Welcome to SANA Check-In</h2>
    <p>Please enter your password</p>

    <input id="nameInput" placeholder="Name (optional)">
    <br>
    <input id="passwordInput" type="password" placeholder="Password">

    <button id="loginBtn">Login</button>
  </div>

  <!-- ---------------- MAIN PAGE ---------------- -->
  <div id="mainPage" class="page">
    <img id="topIcon" src="images/SANA_simple.png" alt="SANA icon">

    <h1>Your Weekly Check-In</h1>
    <p>Select up to three words that describe your week:</p>

    <div id="wordContainer" class="word-list"></div>

    <p>Optional comment:</p>
    <textarea id="comment" placeholder="Write your reflection..."></textarea>

    <button id="submitBtn" class="main-btn" disabled>Submit</button>

    <button id="adminBtn" class="main-btn" style="display:none;">
      Admin: View Word Cloud
    </button>
  </div>

  <!-- ---------------- SCRIPT ---------------- -->
  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwWDyuw9r1IQCWZzGBC2up3pN53X3BpjQRnCDRbZpXsmQ70UYTTjUQQUUXeR80YkqFXTg/exec";

    const USER_PW = "Weekly123!";
    const ADMIN_PW = "Adminweekly!";

    let isAdmin = false;
    let selected = [];

    const words = [
      "Stressed", "Satisfied", "Bored", "Motivated", "Tired",
      "Inspired", "Frustrated", "Happy", "Pressured", "Calm",
      "Hopeful", "Grateful", "Productive", "Confused", "Focused",
      "Excited", "Defeated", "Content"
    ];

    // LOGIN ------------------------------------------------------
    document.getElementById("loginBtn").addEventListener("click", () => {
      const pw = document.getElementById("passwordInput").value;

      if (pw === USER_PW) {
        isAdmin = false;
        startApp();
      } else if (pw === ADMIN_PW) {
        isAdmin = true;
        startApp();
      } else {
        alert("Incorrect password");
      }
    });

    function startApp() {
      document.getElementById("loginPage").style.display = "none";
      document.getElementById("mainPage").style.display = "block";

      if (isAdmin) {
        document.getElementById("adminBtn").style.display = "block";
      }

      renderWords();
    }

    // RENDER WORDS ------------------------------------------------
    function renderWords() {
      const container = document.getElementById("wordContainer");
      container.innerHTML = "";

      words.forEach(word => {
        const div = document.createElement("div");
        div.className = "word-item";
        div.innerText = word;

        div.addEventListener("click", () => {
          if (selected.includes(word)) {
            selected = selected.filter(w => w !== word);
            div.classList.remove("selected");
          } else {
            if (selected.length < 3) {
              selected.push(word);
              div.classList.add("selected");
            }
          }
          document.getElementById("submitBtn").disabled = selected.length === 0;
        });

        container.appendChild(div);
      });
    }

    // SUBMIT ------------------------------------------------------
    document.getElementById("submitBtn").addEventListener("click", async () => {
      const name = document.getElementById("nameInput").value || "";
      const comment = document.getElementById("comment").value;

      const payload = { name, words: selected, comment };

      try {
        await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        alert("Thank you! Your check-in is submitted.");
        window.location.reload();
      } catch (err) {
        console.error(err);
        alert("Error submitting your check-in.");
      }
    });

    // ADMIN BUTTON ------------------------------------------------
    document.getElementById("adminBtn").addEventListener("click", () => {
      window.location.href = "dashboard.html";
    });
  </script>

</body>
</html>
